var path="";
device.vibrate(100);
toast("请给予无障碍服务权限")
auto.waitFor();
toast("请给予悬浮窗权限");

var window = floaty.window(
    <vertical w="90" alpha="0.8">
        <button  style="Widget.AppCompat.Button.Colored" id="about" text="PY脚本哥" />
        <button id="openn" text="打开App" />
        <button id="action" text="运行脚本" />

        
        <button id="goaway" text="退出脚本" />
    </vertical>
);


window.exitOnClose();
path = "./work2.log";
window.setPosition(0,device.height*0.3);


var execution = null;

window.about.click(()=>{
    device.vibrate(300);
    toast("脚本哥免费出品，Q群：16768994")
    app.startActivity({
action: "android.intent.action.VIEW",
data: "mqqopensdkapi://bizAgent/qm/qr?url=http%3A%2F%2Fqm.qq.com%2Fcgi-bin%2Fqm%2Fqr%3Ffrom%3Dapp%26p%3Dandroid%26k%3D-XJTzxSmC3gHeO-kR1fPu5yd_TrNzyat",
packageName: "com.tencent.mobileqq",
});

    });
    
window.openn.click(()=>{
    device.vibrate(100);
    launch("com.jm.android.jumei");
    toast("请等待App首页出现且无任何遮盖窗口时点击运行脚本");
    });


window.action.click(()=>{
    device.vibrate(100);
    if(window.action.getText() == '运行脚本'){
        window.action.setText('停止运行');
     execution = engines.execScriptFile(path);
        }
    else{
        if(execution){
            execution.getEngine().forceStop();
        }
        window.action.setText('运行脚本');
    }
});


window.goaway.click(()=>{
  if(execution){
            execution.getEngine().forceStop();}
            device.vibrate(100);
exit();
});


setInterval(()=>{}, 1000);

